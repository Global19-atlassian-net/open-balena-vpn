ca ca.crt
key server.key
cert server.crt

dh dh1024.pem
# We don't care about windows compatability, just assign individual IP addresses.
ifconfig-pool-linear

persist-key
persist-tun

proto tcp-server
comp-lzo
keepalive {{ getenv "VPN_KEEPALIVE_FREQUENCY" "10" }} {{ getenv "VPN_KEEPALIVE_TIMEOUT" "60" }}

# Increase the max clients from the default of 1024
max-clients 32768

# Allow authorisation via username/password.
script-security 3 # Level 3 for username/password auth
client-cert-not-required
username-as-common-name

mode server
tls-server

group nogroup
user nobody

verb 3
mute 20

# use system defaults for sndbuf/rcvbuf - https://community.openvpn.net/openvpn/ticket/461
sndbuf 0
rcvbuf 0
push "sndbuf 0"
push "rcvbuf 0"

# increase handshake window and timeout - https://community.openvpn.net/openvpn/ticket/543
hand-window 600
tls-timeout 20

# use TCP_NODELAY socket option on both ends of connection
tcp-nodelay

# disable tls renegotiation hourly in favour of every 1GB to avoid load spikes
reneg-sec 0
reneg-bytes 1073741824
