# Change Log

All notable changes to this project will be documented in this file
automatically by Versionist. DO NOT EDIT THIS FILE MANUALLY!
This project adheres to [Semantic Versioning](http://semver.org/).

## v3.4.3 - 2018-02-14

* Report version on startup (and fix sentry release tracking) #90 [Will Boyce]

## v3.4.2 - 2018-02-08

* Log device state when successfully updated #86 [Will Boyce]

## v3.4.1 - 2018-02-06

* Allow override of OpenVPN keepalive values via env #84 [Will Boyce]

## v3.4.0 - 2018-01-12

* Update OpenVPN (2.4) and OpenSSL (1.0.2) #82 [Will Boyce]

## v3.3.0 - 2017-12-15

* Use clustering in connect proxy #79 [Will Boyce]

## v3.2.0 - 2017-12-15

* Rewrite connect proxy in typescript and update node-tunnel #77 [Will Boyce]

## v3.1.0 - 2017-12-15

* Log uuid of device when auth fails #78 [Will Boyce]

## v3.0.10 - 2017-12-14

* Use `typed-error` for custom Error classes #75 [Will Boyce]

## v3.0.9 - 2017-12-13

* Avoid flooding API with requests when many devices (dis)connect #73 [John (Jack) Brown]

## v3.0.8 - 2017-12-12

* Auto-deploy master branch builds to staging #72 [Will Boyce]

## v3.0.7 - 2017-11-29

* Add ability to use trusted self-signed root CAs in the VPN service, for the OnPrem solution. #66 [Heds Simons]

## v3.0.6 - 2017-11-27

* Do not report `HandledTunnelingError` to Sentry #70 [Will Boyce]

## v3.0.5 - 2017-11-21

* Rotate openvpn keys; add Makefile for key management #67 [John (Jack) Brown]

## v3.0.4 - 2017-10-31

* Update base image to `resin-base:v2.9.2` #63 [Will Boyce]

## v3.0.3 - 2017-10-23

* Update to pinejs-client ^4.2.3 #62 [Pagan Gazzard]

## v3.0.2 - 2017-10-17

* Simplify errors.ts #60 [Pagan Gazzard]

## v3.0.1 - 2017-10-17

* `captureException` should use pre-configured `Raven` #58 [Will Boyce]
* Add tslint and fix lint errors #58 [Will Boyce]

## v3.0.0 - 2017-10-10

* Remove GET /api/v1/clients endpoint #54 [Will Boyce]

## v2.1.1 - 2017-10-10

* Report errors to sentry #38 [Will Boyce]

## v2.1.0 - 2017-10-06

* Start the typescript conversion; convert src/libs/post-pool to typescript #57 [Pagan Gazzard]

## v2.0.4 - 2017-09-04

* Add `Restart=always` directive to openvpn@.service #51 [Will Boyce]
* Set "max locked memory" limit to unlimited for openvpn service #51 [Will Boyce]

## v2.0.3 - 2017-08-03

* Remove jenkins scripts [Will Boyce]

## v2.0.2 - 2017-07-19

* Update `resin-lint` and fix lint errors [Will Boyce]

## v2.0.1 - 2017-06-30

* Add PR template [Kostas Lekkas]

## v2.0.0 - 2017-05-29

* Pull device information from the API using the v2 endpoint [Ariel Flesler]
* Remove reset-all, register service on API, include service ID on connect & disconnect requests [Ariel Flesler]

## v1.3.2 - 2017-05-25

* Add circle ci config [Will Boyce]

## v1.3.1 - 2017-05-16

* Lint the code only on prepush hook, before running the tests [Ariel Flesler]

## v1.3.0 - 2017-05-16

* Change base image to resin-base:2, remove resin-jwt dependency and use api key-based authentication [Kostas Lekkas]

## v1.2.1 - 2017-05-16

* Hotfix: resolve promise chain before recursing [Petros Angelatos]

## v1.2.0 - 2017-05-15

* Update openvpn config [Will Boyce]

## v1.1.2 - 2017-05-10

* Add a Promise.timeout for connect/disconnect events [Pagan Gazzard]

## v1.1.1 - 2017-04-07

* Implement linting on precommit and fast tests on prepush [Ariel Flesler]

## v1.1.0 - 2017-03-21

* Revert "apply fix for small sndbuf/rcvbuf in openvpn" [Will Boyce]
* Apply fix for small sndbuf/rcvbuf in openvpn [Will Boyce]

## v1.0.0 - 2017-02-23

* Changed the queuing logic so that it is per device, and will only send the latest state. [Internal] [Page]
* Removed reset-all when updating device state fails, just retry until it succeeds. [Internal] [Page]
* Fixed a `TypeError: Cannot read property 'statusCode' of undefined` error. [Internal] [Page]

# 2016-10-10

* Defined timeouts on all requests, to help with hung connections. [Internal] [Page]
* Decreased amount of times to retry a request, so it doesn't retry essentially forever. [Internal] [Page]
* Increased max clients to 32768 [Internal] [Page]

# 2016-06-28

* Fix unused and undefined variables [Internal] [Kostas]
* Added bw_by_user.sh script for calculating the bandwidth used by user's devices on VPN [Internal] [Praneeth]

# 2016-06-01

* Update to node-tunnel@0.2.2 - Fix eternal FIN-WAIT-2 by dropping support for half-closed connections [External][Kostas]
* Improved tunneling error logging [Internal] [Kostas]

# 2016-05-11

* Use forked libnss-openvpn to fix leaked file descriptors. [Internal] [Aleksis]

# 2016-04-27

* Whitelist device port 22222 for proxy api key [External] [Kostas]
* Remove legacy activePort so that resin-vpn can safely be restarted. [Internal] [Aleksis]
* Use resin-lint [Internal] [Kostas]
* Remove device port 4200 from web access whitelist [External] [Kostas]
* Updated dependencies [Internal] [Page]
* Reduce noise in logs [Internal] [Kostas]
* Always restart resin-vpn.service if process exits or is killed. [Internal] [Kostas]

# 2016-01-20

* Wait a while after starting VPN to do the reset-all, to reduce the number of devices that appear offline during the mass reconnect. [Internal] [Page]
* Fixed client events http status code check. [Internal] [Aleksis]
* Update pinejs-client to include the escaping fix. [Internal] [Page]
* Updated to the new resin-base. [Internal] [Page]

# 2015-01-05

* Use the uuid to connect to the device, rather than relying on the api reported vpn_address which may be incorrect. [Internal] [Page]

# 2015-12-01

* Updated the vpn server certificate for another two years, to `Nov 23 16:10:32 2017 GMT` [Internal] [Page]
* Switched to a purely etcd backed confd. [Internal] [Page]
* Updated resin-base to include nodejs v4. [Internal] [Page]
* Removed reverse-proxy as it's going to continue living in resin-proxy with fixes. [Internal] [Page]

# 2015-11-12

* Allow connecting to devices via uuid rather than ip, using `${uuid}.vpn` [Internal] [Page]
* Fix the grammar of the proxy error pages. [Page]

# 2015-10-01

* Added winston logging module and improved logging on tunnel requests.
* Fixed an rsyslogd infinite restart loop when there is no logentries token. [Page]

# 2015-08-17

* Use JWT to authenticate requests from the API. [Aleksis]
* Try to populate the docker cache before building. [Page]
* Switched to using a tagged version of resin-base. [Page]

# 2015-07-26

* Added a /ping endpoint. [Aleksis]
* Switched to http/1.0 for the reverse proxy - necessary for some nc versions (eg OSX). [Aleksis]
* Always used the short commit hash for tagging. [Petros]
* Improved test script. [Aleksis]
* Switched logentries to TLS. [Petros]
* Switched to using some published modules. [Aleksis]
* Added VPN reverse proxy. [Aleksis]
* Report additional data on auth fail. [Lorenzo]

# 2015-07-17

* Changed to support newer resin-base with confd 0.10.0 [Page]
* Added VPN proxy. [Aleksis]
* Cleaned up openvpn-nc. [Aleksis]
* Disable autogeneration of openvpn services. [Petros]

# 2015-06-10

* Fix reset-all error handler [Aleksis]
* Fix VPN race condition causing incorrect online/offline state [petrosagg]
* Use less aggressive keepalive settings [petrosagg]

# 2015-05-13

v0.1.1
* Request API to reset all clients state when VPN starts and on event message failure. [Aleksis]
* Fix race condition of /dev/net/tun device node creation [petrosagg]
* Fix typo in client authentication [Page]

v0.1.0
* Switched to using resin-base. [Aleksis]
* Improved tests and made them able to be run by jenkins. [Aleksis]
